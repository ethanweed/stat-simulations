---
title: "Shapiro-Wilkes Simulation"
author: "Ethan Weed"
date: "3/24/2020"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Estimated distributions of percentages of p-values > 0.05 for Shapiro-Wilkes test with samples drawn from a uniform distribution. Represents the frequency with which we could expect the Shapiro-Wilkes test would lead to the conclusion that the data are normally distributed, when if fact they are uniformally distributed. Data shown of sample sizes of 10, 30, 50, and 75 participants.
```{r echo = T,  message=FALSE, warning = F}
library(ggplot2)
library(cowplot)
set.seed(42)


FalseNegative <- function(N){
  s <- NULL
  for (i in 1:1000){
    m <- NULL
    for (j in 1:100){
      data <- runif(N)
      a <- shapiro.test(data) 
      p <- a$p.value
      if (p > 0.05){
        m <- append(m,p)
      }
    }
    s <- append(s,length(m))
  }
  
  x <- seq(1:length(s))
  
  df <- data.frame(x,s)
  mu <- mean(df$s)
  ggplot(df, aes(s)) +
    geom_density() +
    theme_cowplot() +
    geom_vline(xintercept = mu) +
    geom_label(aes(x = mu, label = mu, y = 0.18)) +
    xlim(0,100) +
    ylim(0,.2) +
    labs(x = "percent",
         title = paste0(N, " Participants"))
}


p1 <- FalseNegative(10)
p2 <- FalseNegative(30)
p3 <- FalseNegative(50)
p4 <- FalseNegative(75)

plot_grid(p1, p2, p3, p4)

```

